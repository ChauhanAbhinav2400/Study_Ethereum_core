ðŸŒŠ 1. The Meaning â€” What Is â€œImpermanent Lossâ€?

Letâ€™s begin simple.

Impermanent loss is the loss of value an LP experiences compared to just holding the tokens outside the pool, due to price changes between the paired assets.

âš™ï¸ Example (The Intuitive View)

Imagine:

Youâ€™re an LP in an ETH/USDT pool.

You deposit 1 ETH = $1000, and 1000 USDT.

Total value = $2000.

The pool ratio is 1:1000 (price of ETH = $1000).

Now ETH price rises to $2000 on external markets.

If you had simply held:

1 ETH = $2000

1000 USDT = $1000
â†’ total = $3000

But the pool adjusts itself using the AMM formula 
ð‘¥
Ã—
ð‘¦
=
ð‘˜
xÃ—y=k.
Letâ€™s see what happens.

ðŸ§® 2. How the Pool Reacts to Price Change
Step 1: Initial condition

reserveETH = 10 ETH

reserveUSDT = 10,000 USDT

price = 1000 USDT/ETH

ð‘˜
=
10
Ã—
10
,
000
=
100
,
000
k=10Ã—10,000=100,000

Step 2: ETH price doubles to 2000 USDT.

Traders arbitrage:

Buy ETH from the pool until the poolâ€™s internal price matches external price.

So pool adjusts.

Letâ€™s find new reserves.

ð‘Ÿ
ð‘’
ð‘ 
ð‘’
ð‘Ÿ
ð‘£
ð‘’
ð‘ˆ
ð‘†
ð·
ð‘‡
ð‘Ÿ
ð‘’
ð‘ 
ð‘’
ð‘Ÿ
ð‘£
ð‘’
ð¸
ð‘‡
ð»
=
2000
reserveETH
reserveUSDT
	â€‹

=2000

and

ð‘Ÿ
ð‘’
ð‘ 
ð‘’
ð‘Ÿ
ð‘£
ð‘’
ð¸
ð‘‡
ð»
Ã—
ð‘Ÿ
ð‘’
ð‘ 
ð‘’
ð‘Ÿ
ð‘£
ð‘’
ð‘ˆ
ð‘†
ð·
ð‘‡
=
100
,
000
reserveETHÃ—reserveUSDT=100,000

â†’ substitute reserveUSDT = 2000 Ã— reserveETH

ð‘Ÿ
ð‘’
ð‘ 
ð‘’
ð‘Ÿ
ð‘£
ð‘’
ð¸
ð‘‡
ð»
Ã—
(
2000
Ã—
ð‘Ÿ
ð‘’
ð‘ 
ð‘’
ð‘Ÿ
ð‘£
ð‘’
ð¸
ð‘‡
ð»
)
=
100
,
000
reserveETHÃ—(2000Ã—reserveETH)=100,000
2000
Ã—
ð‘Ÿ
ð‘’
ð‘ 
ð‘’
ð‘Ÿ
ð‘£
ð‘’
ð¸
ð‘‡
ð»
2
=
100
,
000
2000Ã—reserveETH
2
=100,000
ð‘Ÿ
ð‘’
ð‘ 
ð‘’
ð‘Ÿ
ð‘£
ð‘’
ð¸
ð‘‡
ð»
=
100
,
000
/
2000
=
50
=
7.071
reserveETH=
100,000/2000
	â€‹

=
50
	â€‹

=7.071
ð‘Ÿ
ð‘’
ð‘ 
ð‘’
ð‘Ÿ
ð‘£
ð‘’
ð‘ˆ
ð‘†
ð·
ð‘‡
=
2000
Ã—
7.071
=
14
,
142
reserveUSDT=2000Ã—7.071=14,142
Step 3: LP owns same % share of pool

Originally you owned 10% of pool â†’
so now you own:

0.7071 ETH (10% of 7.071)

1,414.2 USDT (10% of 14,142)

Your total =
(0.7071 Ã— 2000) + 1414.2 = $2,828.4

Step 4: Compare to HODL

If you had just held:

1 ETH ($2000) + 1000 USDT = $3000

So you lost $171.6 in relative value.

This is the impermanent loss.

ðŸ“‰ 3. Why Itâ€™s Called Impermanent?

Because the loss is not realized until you withdraw.

If later the ETH price returns to $1000,
the pool ratio returns,
and the LPâ€™s value becomes equal again â€” no loss.

â†’ But if you withdraw while prices are still different,
that loss becomes permanent.

Hence the term impermanent loss = â€œtemporary loss relative to HODL, caused by price divergenceâ€.

ðŸ§© 4. The Mathematical Formula

Impermanent loss (IL) depends only on the price ratio change (r):

ð¼
ð¿
=
2
Ã—
ð‘Ÿ
1
+
ð‘Ÿ
âˆ’
1
IL=2Ã—
1+r
r
	â€‹

	â€‹

âˆ’1

where:

ð‘Ÿ
=
ð‘ƒ
ð‘›
ð‘’
ð‘¤
ð‘ƒ
ð‘œ
ð‘™
ð‘‘
r=
P
old
	â€‹

P
new
	â€‹

	â€‹


You can calculate the loss as a percentage of the original value.

ðŸ§® Example Calculations
Price Ratio (r)	IL (%)
1.00 (no change)	0.00%
1.25	-0.60%
1.50	-2.00%
2.00	-5.72%
3.00	-13.40%
4.00	-20.00%
5.00	-25.46%

So the more volatile the price,
the larger the IL.

âš–ï¸ 5. Why Does This Happen? (Core Intuition)

The AMM always keeps the product constant (x*y=k).
So when one assetâ€™s price increases,
the pool automatically sells some of it to rebalance.

That means:

When price goes up â†’ LP sells part of the rising asset early.

When price goes down â†’ LP buys more of the falling asset.

So the pool is always rebalancing in the opposite direction of the market â€”
thatâ€™s why it loses compared to simply holding.

ðŸ’¡ Impermanent loss = the cost of providing liquidity (inventory rebalancing loss).

ðŸ§  6. Visualizing It

Imagine you have a see-saw:
ETH on one side, USDT on the other.

Whenever ETHâ€™s price rises, the see-saw tilts â€”
the pool adjusts weights to keep balance.

You end up with less of the rising asset and more of the stable one.

Thatâ€™s exactly what IL represents â€”
the pool automatically â€œsells winners and buys losersâ€.

ðŸ’° 7. Why LPs Still Earn (Fees Offset IL)

Despite impermanent loss, LPs often still profit due to trading fees.

Letâ€™s say:

Pool charges 0.3% per trade.

ETH price doubles â†’ lots of trading activity.

You earn accumulated fees proportional to your pool share.

If total trading volume is high enough,
your fee income can exceed the impermanent loss.

Thatâ€™s why AMMs on volatile pairs (like ETH/USDT) are profitable only when thereâ€™s enough trading volume.

ðŸ§© 8. Code-Level Intuition (How Youâ€™d Simulate IL)

You can calculate impermanent loss off-chain or in a Solidity helper function like this:

function getImpermanentLoss(uint priceChangeRatio) public pure returns (int) {
    // IL = 2 * sqrt(r)/(1 + r) - 1
    uint numerator = sqrt(priceChangeRatio) * 2e18; // scaled
    uint denominator = (1e18 + priceChangeRatio);
    int IL = int(numerator / denominator) - 1e18;
    return IL; // negative value means loss %
}

function sqrt(uint y) internal pure returns (uint z) {
    if (y > 3) {
        z = y;
        uint x = y / 2 + 1;
        while (x < z) {
            z = x;
            x = (y / x + x) / 2;
        }
    } else if (y != 0) z = 1;
}


Call with:

getImpermanentLoss(2e18); // 2x price â†’ ~ -5.7% loss

ðŸ§® 9. Real-World Illustration
Case A â€” HODL

1 ETH = $1000 â†’ $2000 = 2Ã—

1 ETH + 1000 USDT â†’ $3000 total.

Case B â€” LP

After AMM rebalance:

You hold 0.7071 ETH + 1414 USDT = $2828.

Loss = -5.72%.

But if during that period you earned, say, $250 in trading fees â†’
$2828 + $250 = $3078 â†’ still profitable.

Thatâ€™s the fee vs IL balance every LP must consider.

âš™ï¸ 10. Factors Affecting IL
Factor	Impact
Volatility	Higher volatility â†’ higher IL
Stable pairs	Low IL (e.g., USDC/DAI)
Fees	Can offset IL
Liquidity depth	Deep pools have smaller price impact per trade
Time in pool	Long-term exposure to volatility accumulates IL
ðŸ’¡ 11. How LPs Minimize IL

Provide liquidity to stablecoin pairs (e.g., DAI/USDC).
â†’ Price doesnâ€™t change much â†’ near-zero IL.

Use Concentrated Liquidity (Uniswap v3)
â†’ Provide liquidity only in tight price ranges.

Use hedging strategies
â†’ Hedge exposure with derivatives or shorting.

Rely on fees and incentives
â†’ High-volume pools can compensate for IL.