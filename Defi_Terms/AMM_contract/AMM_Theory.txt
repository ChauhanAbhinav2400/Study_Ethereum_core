ğŸ§© 1. The Root Problem: Why Do We Need an â€œAutomatedâ€ Market Maker?

Letâ€™s start from the question â€œwhy.â€
Traditional markets (like stock exchanges or Binance) work with Order Books â€” a list of buyers and sellers with their prices.

For example:

Buyer	Price	Seller
wants to buy 1 BTC	$69,000	wants to sell 1 BTC
wants to buy 2 BTC	$68,500	wants to sell 3 BTC at $69,200

The exchange matches buyers and sellers manually or algorithmically.

But in DeFi, there is:

No central exchange,

No order-matching engine,

No market maker institutions (like in Wall Street).

Yet we still want 24/7 on-chain trading between assets like ETH â†” USDT, DAI â†” WBTC, etc.

So, question:
ğŸ‘‰ How can a blockchain enable trading without an order book or centralized market makers?

Answer: by using math and smart contracts.
That math-based mechanism is called an Automated Market Maker (AMM).

âš™ï¸ 2. Definition â€” What is an AMM?

An Automated Market Maker (AMM) is a smart contract that uses a mathematical formula to price assets and execute trades automatically inside a liquidity pool â€” without needing buyers and sellers to match orders.

So instead of humans setting prices, code sets prices based on liquidity pool ratios.

ğŸ§  3. Core Idea â€” Code as the Market Maker

In centralized finance, market makers are institutions that always keep buy/sell orders to ensure liquidity.

In DeFi:

The smart contract plays that role.

The formula ensures that thereâ€™s always a price available for any trade.

Anyone can become a liquidity provider (LP), meaning everyone can be a â€œmini market maker.â€

Hence the name â€” Automated Market Maker.

ğŸ”¢ 4. The Core Formula â€” Constant Product Market Maker (Uniswap v2)

The most famous AMM formula is:

ğ‘¥
Ã—
ğ‘¦
=
ğ‘˜
xÃ—y=k

Where:

ğ‘¥
x = token A reserve

ğ‘¦
y = token B reserve

ğ‘˜
k = constant (always remains same)

This is called the Constant Product Formula â€” introduced by Uniswap.

ğŸ’¡ 5. How It Works (Step-by-Step Example)

Letâ€™s say thereâ€™s a pool of:

10 ETH

20,000 USDT

So:

ğ‘¥
Ã—
ğ‘¦
=
10
Ã—
20
,
000
=
200
,
000
xÃ—y=10Ã—20,000=200,000

Thatâ€™s our constant.

Now someone wants to buy 1 ETH.

Step 1: ETH decreases â†’ 9 ETH remain
ğ‘¥
=
9
x=9
Step 2: To keep k constant, y must increase:
ğ‘¦
=
200
,
000
/
9
=
22
,
222.22
y=200,000/9=22,222.22

So, pool now holds 22,222 USDT.

That means trader paid:
â†’ 22,222 âˆ’ 20,000 = 2,222 USDT for 1 ETH.

Hence, new price = 2,222 USDT/ETH.

âœ… Price automatically adjusted due to the change in pool ratio.

No order book, no negotiation â€” just math.

ğŸ§® 6. The Price Formula Inside AMM

Price of Token A (in terms of Token B) =

ğ‘ƒ
ğ´
=
ğ‘¦
ğ‘¥
P
A
	â€‹

=
x
y
	â€‹


When x decreases (ETH bought), price rises.

When x increases (ETH sold), price falls.

This creates a self-balancing mechanism.

ğŸ’¸ 7. Fee Distribution

When trades happen, a fee (usually 0.3%) is taken and added back to the pool.
That means:

Liquidity providers earn this fee.

Pool value increases over time.

Thatâ€™s how LPs earn yield â†’ which powers yield farming.

ğŸ“ˆ 8. The Curve Shape â€” Constant Product Graph

If you plot 
ğ‘¦
=
ğ‘˜
/
ğ‘¥
y=k/x, you get a hyperbola.

Meaning:

You can never drain the pool completely.

The closer you get to emptying one side, the price skyrockets.

Thatâ€™s why large trades cause slippage â€” price moves significantly as one asset gets scarce.

ğŸ§© 9. Slippage (Price Impact)

When a trade is large relative to pool size,
the formula 
ğ‘¥
âˆ—
ğ‘¦
=
ğ‘˜
xâˆ—y=k forces a nonlinear price rise.

Example:

Pool = 10 ETH, 20,000 USDT.

Buying 0.1 ETH â†’ small impact.

Buying 5 ETH â†’ huge price rise (ETH now much more expensive).

This ensures liquidity always exists, but prices move sharply on large trades.

âš–ï¸ 10. Arbitrage â€” The Balancer of AMMs

Because AMMs price assets via formulas, they may diverge from real market prices (on Binance, Coinbase, etc.).

Example:

Binance ETH = $2000,

Uniswap ETH = $2100.

Arbitrage traders notice this and:

Buy ETH on Binance ($2000),

Sell ETH on Uniswap ($2100),

Profit $100 per ETH.

Their trades push the pool back to equilibrium â€”
AMMs rely on arbitrage to maintain accurate prices.

So arbitrageurs are like natural regulators of AMM prices.

ğŸ§± 11. Variants of AMMs (Evolution Beyond Uniswap v2)
AMM Type	Formula	Use Case	Example
Constant Product (x*y=k)	Standard	Volatile pairs (ETH/USDT)	Uniswap v2, PancakeSwap
Constant Sum (x+y=k)	Keeps price stable	Pegged assets (USDC/DAI)	Rare
Hybrid (Curveâ€™s StableSwap)	Mix of product + sum	Stablecoins	Curve Finance
Weighted AMM	
ğ‘¥
ğ‘¤
âˆ—
ğ‘¦
(
1
âˆ’
ğ‘¤
)
=
ğ‘˜
x
w
âˆ—y
(1âˆ’w)
=k	Custom ratios	Balancer (e.g., 80/20 pools)
Dynamic AMMs	Adjust formulas over time	Efficient liquidity	Uniswap v3 (concentrated liquidity)
âš™ï¸ 12. Inside the Smart Contract â€” What AMM Code Does

An AMM smart contract typically:

Stores reserves (token A and B)

Computes output using 
ğ‘¥
âˆ—
ğ‘¦
=
ğ‘˜
xâˆ—y=k

Applies trading fee

Updates new reserves

Mints/burns LP tokens

Transfers tokens to trader

So itâ€™s a fully on-chain exchange engine written in Solidity.

ğŸ§  13. Key Mathematical Insight â€” Why It Works

The genius of AMMs is that liquidity is continuous.

Even if:

Thereâ€™s only one LP,

No one else trading,

You can still buy or sell any amount,
because the formula always gives a valid price.
You just pay more for larger trades.

Itâ€™s a deterministic market â€” price = math, not mood.

ğŸ’¥ 14. Impermanent Loss Connection

When prices of assets in the pool move in the external market,
the poolâ€™s internal ratio adjusts â€”
causing the LPâ€™s asset value to diverge from just holding.

Thatâ€™s called impermanent loss,
and it directly comes from how AMM math works.

Weâ€™ll unpack that mathematically next if you want.

ğŸ§© 15. Real-World Analogy

Imagine a vending machine that sells apples for oranges. ğŸ â†” ğŸŠ

The machine starts with 10 apples and 10 oranges.

Every time someone buys apples, the machine increases the apple price.

Every time someone buys oranges, orange price rises.

It never â€œruns outâ€ â€” it just makes the next unit more expensive.
Thatâ€™s exactly what AMMs do.

ğŸ§® 16. Example of AMM in Action
Starting pool:

10 ETH + 20,000 USDT
k = 200,000

Trader swaps 1 ETH for USDT.

Step	ETH	USDT	Price (USDT/ETH)	Action
Start	10	20,000	2000	Initial
After Trade	9	22,222	2469	ETH becomes costlier

Now another trader swaps 1 ETH â†’ opposite trade:

Step	ETH	USDT	Price	Comment
After Trade	10	20,000	2000	Price rebalanced

ğŸ’¡ Constant product k stayed 200,000 throughout.

ğŸ§­ 17. AMM Limitations
Issue	Explanation
Slippage	Large trades move price significantly
Impermanent Loss	LPs lose value when price diverges
Front-running	Bots exploit transaction order
Low Capital Efficiency	Liquidity is spread thin across all prices (fixed in Uniswap v3)
ğŸ§± 18. AMM Upgrades â€” Uniswap v3 & Beyond

Uniswap v3 introduced Concentrated Liquidity AMMs:

LPs choose price ranges where they want to provide liquidity.

Higher efficiency, less idle capital.

More complex but more powerful.

Itâ€™s like replacing one big pool with many small custom pools.

âœ… 19. Summary Table
Concept	Description	Example
AMM	Code that sets prices & executes trades	Uniswap, Curve
Formula	Math relationship controlling pool	x*y=k
Liquidity Pool	Reserve of token pairs	ETH/USDT
LP Token	Proof of liquidity contribution	UNI-V2
Slippage	Price difference from pool ratio	Large swaps
Arbitrage	External traders balance prices	Binance vs Uniswap
Fee	Reward for LPs	0.3% typical
ğŸŒ 20. In One Line

An Automated Market Maker (AMM) is a decentralized pricing algorithm that uses math (like x*y=k) inside liquidity pools to allow instant, trustless trading â€” replacing traditional order books and human market makers.